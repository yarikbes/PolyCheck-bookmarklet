(function(){alert("Букмарклет PolyCheck запущен");const e=["casino bonus","jackpot","cashback","no deposit bonus","withdrawal","balance","live","vip","account","bet","spin","mobile","bonus code","promo code","free spins","rakeback","reload bonus","welcome package","wagering requirements","minimum deposit","bonus funds","bonus percentage","bonus terms","bonus validity","matched deposit","matched reward","tailored offer","activate bonus","claim bonus","exclusive promotion","valid promo code","private event","highroller","cash out","registration bonus","promotions","wagering requirements","rtp","return to player","payout"],t=e.map(e=>e.toLowerCase()),a={'en-US':["favorite","color","center","organize","analyze","license","program","catalog"],'en-GB':["favourite","colour","centre","organise","analyse","licence","programme","catalogue"],'pt-PT':["prémio","levantamento","apoio ao cliente","reembolso"],'pt-BR':["prêmio","saque","atendimento ao cliente"],'es-ES':["máquina tragamonedas","dinero","trabajo","hola"],'es-AR':["tragamonedas","guita","laburo","che","boludo"],'de-DE':["spielautomat","lizenz","glücksspielstaatsvertrag"],'de-AT/CH':["glücksspielautomat","konzession","glücksspielgesetz","geldspielgesetz"],'fr-FR':["mise","retrait","joueur"],'fr-CA':["pari","encaissement","joueuse"],'sv-SE':["spel","insättning","uttag","vinst"],'nl-NL':["gokken","inzet","uitbetaling"]},n={'en-US':["wager","cashout","reels","multiplier","wagering requirement","rtp"],'en-GB':["stake","payline","punt","punter","return to player"],'pt-PT':["slot machine","caça-níquel","jogos de sorte","giros grátis","saldo","levantamento mínimo"],'pt-BR':["cassino","jogos de azar","aposta mínima","giros grátis","saldo"],'es-ES':["bote","tiradas gratis","retiro","servicio de atención al cliente","apuesta mínima","juego de mesa","crupier","tragaperras"],'es-AR':["pozo","giros gratis","extracción","cobro","saque","retirar","apuestas deportivas"],'de-DE':["einsatz","auszahlung","freispiele","wettquote","mindesteinsatz","spielregeln","bonusspiel"],'de-AT/CH':["einsatzgrenze","auszahlungen","wette","wettanbieter","spielregeln","bonusspiel"],'sv-SE':["spelautomater","insättning","uttag","vinster","jackpott","kampanjer","betalningsmetoder"],'nl-NL':["gokkasten","welkomstbonus","gratis spins","uitbetaling","storting","klantenservice","mobiel casino","betalningsmethoden"],'fr-FR':["mise","retrait","joueur","pari"],'fr-CA':["pari","encaissement","joueuse","mise","gain"]},r=["free-spins","high-rollers","non-sticky","live-dealer","e-sports","real-time","in-play","pre-match","live-streaming","multi-bets","single-bets","match-winner","first-tower","dragon-slay","bonus-crab","event-based","user-friendly","real-money","mobile-optimized","top-tier","high-volatility","live-betting","fast-paced","must-try","high-end","must-play","time-limited","high-stakes","stand-alone","non-stop","blockbuster"].map(e=>e.toLowerCase()),o={'en-GB':"GBP",'en-US':"USD",'pt-PT':"EUR",'pt-BR':"BRL",'es-ES':"EUR",'es-AR':"ARS",'de-DE':"EUR",'de-AT/CH':"EUR",'fr-FR':"EUR",'fr-CA':"CAD",'sv-SE':"SEK",'nl-NL':"EUR"};function s(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}async function i(){try{const e=await navigator.clipboard.readText();if(e&&e.trim())return e;alert("Буфер обмена пуст. Выделите текст, скопируйте его (Ctrl+C или Cmd+C) и запустите букмарклет снова.");return""}catch(e){console.warn("Не удалось прочитать буфер обмена:",e);const t=prompt("Не удалось прочитать буфер обмена. Пожалуйста, вставьте текст сюда (Ctrl+V или Cmd+V):","");if(t&&t.trim())return t;alert("Текст не был введён. Попробуйте снова.");return""}}function l(e){const i={wordMarkerStats:{counts:{},words:{}},orthoMarkerStats:{counts:{},words:{}},isIGamingText:!1,duplicateWords:[],duplicateSentences:new Set,potentialTypos:new Set,hasEnDash:!1,foundCurrencies:{},currencyReportStrings:[]},l=e.split(/\s+/);i.isIGamingText=e.some(t=>{const a=new RegExp("\\b"+s(t)+"\\b","gi");return a.test(e)});for(const e in n){i.wordMarkerStats.counts[e]=0,i.wordMarkerStats.words[e]=[],n[e].forEach(t=>{const a=new RegExp("\\b"+s(t)+"\\b","gi"),n=e.match(a);n&&(!i.isIGamingText||!t.includes(t.toLowerCase()))&&(i.wordMarkerStats.counts[e]+=n.length,i.wordMarkerStats.words[e].push(`${t} (${n.length})`))})}for(const e in a){i.orthoMarkerStats.counts[e]=0,i.orthoMarkerStats.words[e]=[],a[e].forEach(t=>{const a=new RegExp("\\b"+s(t)+"\\b","gi"),n=e.match(a);n&&(i.orthoMarkerStats.counts[e]+=n.length,i.orthoMarkerStats.words[e].push(`${t} (${n.length})`))})}for(let e=0;e<l.length-1;e++){const t=l[e].toLowerCase().replace(/[.,;:!?]$/,""),a=l[e+1].toLowerCase().replace(/[.,;:!?]$/,"");if(t===a&&t.length>2){const n=`${l[e]} ${l[e+1]}`;i.duplicateWords.includes(n)||i.duplicateWords.push(n)}}const c=e.split(/[.!?]+/).map(e=>e.trim().toLowerCase()).filter(e=>e.length>10),d={};c.forEach(e=>{d[e]=(d[e]||0)+1});for(const e in d)if(d[e]>1){const t=new RegExp(s(e),"i"),a=e.match(t);i.duplicateSentences.add(a?a[0]:e)}l.forEach((e,t)=>{const a=e.replace(/[.,;:!?]$/,"");if(/[#@$]/.test(a)&&!a.match(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)&&!a.startsWith("#")&&i.potentialTypos.add(e),/-/.test(e)){const t=e.toLowerCase();if(!r.includes(t)&&(e.match(/^-\S|\S-$/)||e.includes(" -")||e.includes("- "))&&(!r.includes(t.replace(/\s*-\s*/,"-"))&&i.potentialTypos.add(e),1));}const n=/(\w+)([^-\s\w,.!?;:'"]+)(\w+)?|(\w+)([^-\s\w,.!?;:'"]+)\s|[^-\s\w,.!?;:'"]+(\w+)/;n.test(e)&&!r.includes(e.toLowerCase())&&(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)&&!e.startsWith("http")&&i.potentialTypos.add(e))}),i.hasEnDash=/–/g.test(e);const u=[...new Set(Object.values(o))];return u.forEach(t=>{const a=new RegExp(`(\\b${t}\\b(?:\\s*\\d+(?:[.,]\\d+)?)?|\\d+(?:[.,]\\d+)?\\s*\\b${t}\\b|\\p{Sc}\\s*\\d+(?:[.,]\\d+)?|\\d+(?:[.,]\\d+)?\\s*\\p{Sc})`,"gu"),n=e.match(a)||[],r=[];let l=0;n.forEach(e=>{let a=!1;const n=e.toLowerCase(),s=t.toLowerCase();if(n.includes(s))a=!0;else if("GBP"===t&&e.includes("£")||"USD"===t&&e.includes("$")||"EUR"===t&&e.includes("€")||"BRL"===t&&n.includes("r$")||"CAD"!==t&&"ARS"!==t||(a=!0);a&&(l++,r.length<5&&r.push(e))}),l>0&&(i.foundCurrencies[t]=(i.foundCurrencies[t]||0)+l,i.currencyReportStrings.push(`${t}: ${l}${r.length>0?` (примеры: ${r.join(", ")}${l>r.length?", ...":""})`:""}`))}),i.duplicateSentences=Array.from(i.duplicateSentences),i.potentialTypos=Array.from(i.potentialTypos),i}function c(e){let t=0,a="Не определён",n=!1;for(const r in e.counts)e.counts[r]>t?(t=e.counts[r],a=r,n=!1):e.counts[r]===t&&t>0&&(n=!0);return n?{language:"Смешанный"}:{language:a}}function d(t,a){let n=document.getElementById("polycheck-popup");n&&n.remove();const r=document.createElement("div");r.id="polycheck-popup",r.style.cssText="all: initial; position: fixed; top: 10%; right: 20px; width: 420px; max-width: 90%;background: #fff; color: #333; border: 1px solid #ccc; border-radius: 8px;padding: 20px; z-index: 2147483647; box-shadow: 0 8px 16px rgba(0,0,0,0.2);font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;font-size: 14px; line-height: 1.6; display: flex; flex-direction: column;";const o=document.createElement("div");o.style.cssText="font-size: 18px; font-weight: bold; color: #005a9e; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; text-align: center;",o.innerHTML='PolyCheck <span style="font-size: 12px; font-weight: normal; color: #777;">v1.2.6</span>',r.appendChild(o);const s=document.createElement("div");s.style.cssText="max-height: 60vh; overflow-y: auto; padding-right: 10px; margin-bottom:15px;";const i=["<strong>Результат анализа:</strong>",`Определенный вариант языка: <span style="background-color: #e6f3fa; padding: 2px 5px; border-radius: 3px;">${t.language}</span>`];"Не определён"!==t.language&&"Смешанный"!==t.language||i.push("<em>(Определение по орфографическим маркерам. Если результат неточен, проверьте наличие специфических слов ниже.)</em>");const l=Object.keys(a.orthoMarkerStats.counts).filter(e=>a.orthoMarkerStats.counts[e]>0);l.length>0&&(i.push("<br><strong>Орфография (по языкам):</strong>"),l.forEach(e=>{i.push(`&nbsp;&nbsp;<strong>${e}:</strong> ${a.orthoMarkerStats.counts[e]} слов(а) (${a.orthoMarkerStats.words[e].join(", ")})`)})),i.push("<br><strong>Анализ iGaming-лексики (возможные несоответствия ГЕО):</strong>");let u=!1;const p=n[t.language]?n[t.language].map(e=>e.toLowerCase()):[];for(const e in a.wordMarkerStats.counts)if(a.wordMarkerStats.counts[e]>0&&e!==t.language){const t=a.wordMarkerStats.words[e].filter(e=>{const t=e.match(/^(.*?)(?= \(\d+\)$)/)[0].toLowerCase();return!p.includes(t)});t.length>0&&(i.push(`&nbsp;&nbsp;Обнаружены слова, характерные для <strong>${e}</strong> (но не для ${t.language}): ${t.length} (${t.join(", ")})`),u=!0)}u||"Не определён"===t.language||"Смешанный"===t.language?"Не определён"===t.language||"Смешанный"===t.language?i.push("&nbsp;&nbsp;<em>Язык не определен однозначно, проверьте все найденные маркеры.</em>"):i.push("&nbsp;&nbsp;<em>Специфическая iGaming-лексика других ГЕО не обнаружена или совпадает с общей/целевой.</em>"):i.push("&nbsp;&nbsp;<em>Специфическая iGaming-лексика других ГЕО не обнаружена или совпадает с общей/целевой.</em>"),a.duplicateWords.length>0&&(i.push("<br><strong>Повторяющиеся слова (рядом):</strong>"),a.duplicateWords.forEach(e=>i.push(`&nbsp;&nbsp;${e}`))),a.duplicateSentences.length>0&&(i.push("<br><strong>Повторяющиеся предложения:</strong>"),a.duplicateSentences.forEach(e=>i.push(`&nbsp;&nbsp;<em>"${e}"</em>`))),a.potentialTypos.length>0&&(i.push("<br><strong>Потенциальные опечатки:</strong>"),a.potentialTypos.forEach(e=>i.push(`&nbsp;&nbsp;${e}`))),a.hasEnDash&&i.push("<br><strong>Обнаружено короткое тире (–):</strong> Рекомендуется заменить на длинное тире (—) или дефис с пробелами в зависимости от контекста."),a.currencyReportStrings.length>0&&(i.push("<br><strong>Валюты в тексте:</strong>"),a.currencyReportStrings.forEach(e=>i.push(`&nbsp;&nbsp;${e}`)));const g=o[t.language];if(g){const e=Object.keys(a.foundCurrencies);e.includes(g)||e.length<=0?e.includes(g)||e.length<=0||i.push(`&nbsp;&nbsp;<strong style="color:orange;">Внимание:</strong> Ожидаемая валюта для ${t.language} (${g}) не найдена, но есть другие: ${e.join(", ")}.`):i.push(`&nbsp;&nbsp;<strong style="color:orange;">Несоответствие валют:</strong> Для ${t.language} ожидается ${g}, но также найдены: ${e.filter(e=>e!==g&&a.foundCurrencies[e]>0).join(", ")}.`)}"Не определён"!==t.language&&"Смешанный"!==t.language||g||i.push(`&nbsp;&nbsp;<em>Для языка ${t.language} не задана ожидаемая валюта в настройках букмарклета.</em>`),i.forEach(e=>{const t=document.createElement("div");t.style.padding="3px 0";let a=e;if(e.includes("(")&&e.includes(")")){const n=/([a-zA-Zа-яА-ЯёЁ0-9@$._'-]+(?: [a-zA-Zа-яА-ЯёЁ0-9@$._'-]+)* \(\d+\))/g;a=e.replace(n,e=>{const a=e.match(/^(.*?)(?= \(\d+\)$)/);return a&&a[1]?`<span class="clickable-word" title="Копировать '${a[1]}'" data-copy="${m(a[1])}">${e}</span>`:e})}t.innerHTML=a,s.appendChild(t)});const y=document.createElement("style");y.type="text/css",y.innerText=".clickable-word { color: #005a9e; cursor: pointer; text-decoration: underline; }\n            .clickable-word:hover { color: #003366; }\n            .copied-feedback { color: green !important; font-weight: bold; }",document.head.appendChild(y),s.addEventListener("click",function(e){if(e.target.classList.contains("clickable-word")){const t=e.target.dataset.copy;navigator.clipboard.writeText(t).then(()=>{const a=e.target.textContent;e.target.textContent="Скопировано!",e.target.classList.add("copied-feedback"),setTimeout(()=>{e.target.textContent=a,e.target.classList.remove("copied-feedback")},1500)})["catch"](e=>{console.warn("Не удалось скопировать слово:",e)})}}),r.appendChild(s);const h=document.createElement("div");h.style.cssText="display: flex; justify-content: flex-end; padding-top: 15px; border-top: 1px solid #eee;";const b=document.createElement("button");b.textContent="Копировать отчёт",b.style.cssText="padding: 8px 15px; background-color: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; margin-right: 10px; font-size:13px;",b.onmouseover=()=>b.style.backgroundColor="#45a049",b.onmouseout=()=>b.style.backgroundColor="#4CAF50",b.onclick=()=>{const e=i.map(e=>e.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ")).join("\n");navigator.clipboard.writeText(e).then(()=>{b.textContent="Отчёт скопирован!",setTimeout(()=>{b.textContent="Копировать отчёт"},2e3)})};const f=document.createElement("button");f.textContent="Закрыть",f.style.cssText="padding: 8px 15px; background-color: #f44336; color: white; border: none; border-radius: 5px; cursor: pointer; font-size:13px;",f.onmouseover=()=>f.style.backgroundColor="#e53935",f.onmouseout=()=>f.style.backgroundColor="#f44336",f.onclick=()=>{r.remove(),y&&y.remove()},h.appendChild(b),h.appendChild(f),r.appendChild(h);const k=document.createElement("div");k.style.cssText="text-align: right; font-size: 11px; color: #999; margin-top: 10px;",k.innerHTML='Powered by <a href="https://www.linkedin.com/in/yaroslav-rudyi/" target="_blank" style="color: #005a9e; text-decoration: none;">@yarikbes</a> & Gemini',r.appendChild(k),document.body.appendChild(r)}function m(e){const t=document.createElement("p");return t.appendChild(document.createTextNode(e)),t.innerHTML}(async()=>{try{const e=await i();if(e){const t=l(e),a=c(t.orthoMarkerStats);d(a,t)}}catch(e){alert("Произошла ошибка в работе букмарклет: "+e.message),console.error("Ошибка букмарклет PolyCheck:",e)}})()})();
